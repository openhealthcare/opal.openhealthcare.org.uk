<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../../img/favicon.ico">
        <title>Subrecords - Opal</title>
        <link href="../../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../../css/font-awesome.min.css" rel="stylesheet">
        <link href="../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/purebasic.min.css">
        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
        <![endif]-->

        <script src="../../js/jquery-1.10.2.min.js" defer></script>
        <script src="../../js/bootstrap-3.0.3.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script> 
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
            <div class="container">

                <!-- Collapsed navigation -->
                <div class="navbar-header">
                    <!-- Expander button -->
                    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a class="navbar-brand" href="../..">Opal</a>
                </div>

                <!-- Expanded navigation -->
                <div class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li >
                                <a href="../..">Home</a>
                            </li>
                            <li >
                                <a href="../../installation/">Installation</a>
                            </li>
                            <li >
                                <a href="../../tutorial/">Tutorial</a>
                            </li>
                            <li >
                                <a href="../../guides/topic-guides/">Guides</a>
                            </li>
                            <li >
                                <a href="../reference_guides/">Reference</a>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">Topic Guides <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li >
    <a href="../../guides/components_overview/">Component Overview</a>
</li>
                                    
<li >
    <a href="../../guides/command_line_tool/">Command Line tool</a>
</li>
                                    
<li >
    <a href="../../guides/discoverable/">Discoverable Features</a>
</li>
                                    
<li >
    <a href="../../guides/plugins/">Plugins</a>
</li>
                                    
<li >
    <a href="../../guides/plugins_list/">Plugin List</a>
</li>
                                    
<li >
    <a href="../../guides/datamodel/">Data Model</a>
</li>
                                    
<li >
    <a href="../../guides/archetypes/">Archetypes</a>
</li>
                                    
<li >
    <a href="../../guides/referencedata/">Referencedata</a>
</li>
                                    
<li >
    <a href="../../guides/metadata/">Metadata</a>
</li>
                                    
<li >
    <a href="../../guides/working_with_data_in_angular/">Angular Models</a>
</li>
                                    
<li >
    <a href="../../guides/flow/">Flow</a>
</li>
                                    
<li >
    <a href="../../guides/roles_and_permissions/">Roles & Permissions</a>
</li>
                                    
<li >
    <a href="../../guides/tagging/">Tagging</a>
</li>
                                    
<li >
    <a href="../../guides/json_api/">JSON API</a>
</li>
                                    
<li >
    <a href="../../guides/templates/">Templates</a>
</li>
                                    
<li >
    <a href="../../guides/context_processors/">Context Processors</a>
</li>
                                    
<li >
    <a href="../../guides/static_files/">Static Files</a>
</li>
                                    
<li >
    <a href="../../guides/forms/">Forms</a>
</li>
                                    
<li >
    <a href="../../guides/patient_detail_views/">Patient Detail Views</a>
</li>
                                    
<li >
    <a href="../../guides/list_views/">Patient List Views</a>
</li>
                                    
<li >
    <a href="../../guides/search/">Search Overview</a>
</li>
                                    
<li >
    <a href="../../guides/django_admin/">Django Admin</a>
</li>
                                    
<li >
    <a href="../../guides/contributing.md">Contributing</a>
</li>
                                    
<li >
    <a href="../../guides/development_environment/">Development environment</a>
</li>
                                    
<li >
    <a href="../../guides/deployment/">Deployment</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown active">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">Reference <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li >
    <a href="../episode/">The Episode model</a>
</li>
                                    
<li >
    <a href="../patient/">The Patient model</a>
</li>
                                    
<li class="active">
    <a href="./">Subrecords</a>
</li>
                                    
<li >
    <a href="../user_profile_model/">UserProfile</a>
</li>
                                    
<li >
    <a href="../mixins/">Mixins</a>
</li>
                                    
<li >
    <a href="../opal_application/">OpalApplication</a>
</li>
                                    
<li >
    <a href="../detail_views/">Detail Views</a>
</li>
                                    
<li >
    <a href="../episode_categories/">Episode Categories</a>
</li>
                                    
<li >
    <a href="../schemas/">Schemas</a>
</li>
                                    
<li >
    <a href="../patient_list/">Patient Lists</a>
</li>
                                    
<li >
    <a href="../plugin/">OpalPlugin</a>
</li>
                                    
<li >
    <a href="../core_views/">Core.Views</a>
</li>
                                    
<li >
    <a href="../core_menus/">Menus</a>
</li>
                                    
<li >
    <a href="../javascript/patient_service/">Patient service</a>
</li>
                                    
<li >
    <a href="../javascript/episode_service/">Episode service</a>
</li>
                                    
<li >
    <a href="../javascript/item_service/">Item service</a>
</li>
                                    
<li >
    <a href="../javascript/user_service/">The User service</a>
</li>
                                    
<li >
    <a href="../javascript/patient_summary_service/">Patient summary service</a>
</li>
                                    
<li >
    <a href="../javascript/search_js_services/">Search JS Services</a>
</li>
                                    
<li >
    <a href="../javascript/loaders/">Loaders</a>
</li>
                                    
<li >
    <a href="../form_templatetags/">Form helpers</a>
</li>
                                    
<li >
    <a href="../panels_templatetags/">Panel Template tags</a>
</li>
                                    
<li >
    <a href="../menus_templatetags/">Menu Template tag</a>
</li>
                                    
<li >
    <a href="../javascript/javascript_helpers/">Javascript helpers</a>
</li>
                                    
<li >
    <a href="../search_queries/">Search Queries</a>
</li>
                                    
<li >
    <a href="../settings/">Settings</a>
</li>
                                    
<li >
    <a href="../changelog.md">Changelog</a>
</li>
                                    
<li >
    <a href="../testing/">Testing</a>
</li>
                                    
<li >
    <a href="../javascript/javascript_dependencies/">Javascript dependencies</a>
</li>
                                    
<li >
    <a href="../upgrading/">Upgrading</a>
</li>
                                </ul>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav navbar-right">
                        <li>
                            <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li >
                                <a rel="next" href="../patient/">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li >
                                <a rel="prev" href="../user_profile_model/">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
                <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
        <li class="main active"><a href="#opal-subrecords">Opal Subrecords</a></li>
            <li><a href="#properties">Properties</a></li>
            <li><a href="#methods">Methods</a></li>
            <li><a href="#subrecord-mixins">Subrecord Mixins</a></li>
    </ul>
</div></div>
                <div class="col-md-9" role="main">

<h2 id="opal-subrecords">Opal Subrecords</h2>
<p>Opal Subrecords are models that relate to either Patients or Episodes, and inherit from
base classes <code>opal.models.PatientSubrecord</code> or <code>opal.models.EpisodeSubrecord</code></p>
<p>They themselves inherit from the mixins <code>opal.models.ToDictMixin</code>, <code>opal.models.UpdateFromDict</code></p>
<h3 id="properties">Properties</h3>
<h4 id="subrecord_angular_service">Subrecord._angular_service</h4>
<p>Name of the Angular service you would like to use to customise the initialization of this
subrecord in the javascript layer.</p>
<pre><code class="python">
class Demographics(PatientSubrecord):
    _angular_service = 'Demographics'
</code></pre>

<h4 id="subrecord_icon">Subrecord._icon</h4>
<p>String that provides the name of the icon to use for forms, column headings etc.</p>
<pre><code>class Demographics(PatientSubrecord):
    _icon = 'fa fa-user'
</code></pre>
<h4 id="subrecord_is_singleton">Subrecord._is_singleton</h4>
<p>Boolean that determines whether this subrecord is a singleton.
There may only be one of each singleton Subrecord, which is created whth the parent.</p>
<pre><code class="python">    class Demographics(PatientSubrecord):
        _is_singleton = True
</code></pre>

<p>For this case, when a <code>Patient</code> is created, an empty <code>Demographics</code> instance will
automatically be created.</p>
<h4 id="subrecord_list_limit">Subrecord._list_limit</h4>
<p>Integer to indicate the maximum number of entries to display in list view for this
model. Useful for record types where many entries will accrue, or where display is
particularly verbose.</p>
<pre><code class="python">    class BloodPressureReading(EpisodeSubrecord):
        _list_limit = 3
</code></pre>

<h4 id="subrecord_sort">Subrecord._sort</h4>
<p>Name of the field by which we want to sort these records when displaying.</p>
<pre><code class="python">    class Antimicrobial(EpisodeSubrecord):
        _sort = 'start_date'
</code></pre>

<h4 id="subrecord_title">Subrecord._title</h4>
<p>String we would like to use for user-facing display of this record type.</p>
<pre><code class="python">    class Antimicrobial(EpisodeSubrecord):
        _title = 'Abx'
</code></pre>

<h4 id="subrecord_clonable">Subrecord._clonable</h4>
<p>A Boolean that is True by default used by <code>opal.views.EpisodeCopyToCategoryView</code>
to determine if instances of this record should be copied across.</p>
<pre><code class="python">    class Antimicrobial(EpisodeSubrecord):
        _clonable = 'False'
</code></pre>

<h4 id="subrecord_exclude_from_extract">Subrecord._exclude_from_extract</h4>
<p>Boolean to specify that this subrecord should be excluded from any standard data extract.
This implicitly defaults to False.</p>
<pre><code class="python">    class Antimicrobial(EpisodeSubrecord):
        _exclude_from_extract = 'Abx'
</code></pre>

<h4 id="subrecordpid_fields">Subrecord.pid_fields</h4>
<p>An iterable of strings that correspond to fieldnames that contain Patient Identifiable Data (PID).</p>
<p>This is used when creating data extracts to exclude PID from e.g. CSV downloads.</p>
<h3 id="methods">Methods</h3>
<h4 id="subrecordget_display_template">Subrecord.get_display_template()</h4>
<p>Classmethod to locate the display template for our record. By default this
looks in the location <code>{{ template_dir }}/records/{{ subrecord api name }}.html</code>.</p>
<p>Keywords:</p>
<ul>
<li><code>prefixes</code> An optional list of prefixes that allow you to put templates behind an optional
directory for example:</li>
</ul>
<pre><code class="python">  Subrecord.get_display_template(prefixes=[&quot;example&quot;])
</code></pre>

<p>Would use the first template it found, looking at:</p>
<pre><code>{{ template_dir }}/records/example/subrecord.html
{{ template_dir }}/records/subrecord.html
</code></pre>

<h4 id="subrecordget_detail_template">Subrecord.get_detail_template()</h4>
<p>Classmethod to locate a more detailed template for the subrecord. This is the
template used by the record panel. It looks for a template in
<code>{{ template_dir }}/records/{{ subrecord api name }}_detail.html</code>.</p>
<p>It defaults to the display template if it can't find one there.</p>
<p>Keywords:</p>
<ul>
<li><code>prefixes</code> An optional list of prefixes that allow you to put templates behind an optional
directory for example:</li>
</ul>
<pre><code class="python">  Subrecord.get_display_template(prefixes=[&quot;example&quot;])
</code></pre>

<p>Would use the first template it found, looking at:</p>
<pre><code>{{ template_dir }}/records/example/subrecord_detail.html
{{ template_dir }}/records/example/subrecord.html
{{ template_dir }}/records/subrecord_detail.html
{{ template_dir }}/records/subrecord.html
</code></pre>

<h4 id="subrecordget_form_template">Subrecord.get_form_template()</h4>
<p>Classmethod to locate the active template for our record. Returns the name of a template or None.
It looks for a template in <code>{{ template_dir }}/forms/{{ subrecord api name }}_form.html</code></p>
<p>Keywords:</p>
<ul>
<li><code>prefixes</code> An optional list of prefixes that allow you to put templates behind an optional
directory for example:</li>
</ul>
<pre><code class="python">  Subrecord.get_form_template(prefixes=[&quot;example&quot;])
</code></pre>

<p>Would use the first template it found, looking at:</p>
<pre><code>{{ template_dir }}/forms/example/subrecord_form.html
{{ template_dir }}/forms/subrecord_form.html
</code></pre>

<h4 id="subrecordget_modal_template">Subrecord.get_modal_template()</h4>
<p>Classmethod to locate the active template for our record. Returns the name of a template or None.
By default it will render a modal with a form template from Subrecord.get_form_template(). You can
override this by putting a template named <code>{{ template_dir }}/modals/{{ subrecord api name }}_modal.html</code></p>
<p>Keywords:</p>
<ul>
<li><code>prefixes</code> An optional list of prefixes that allow you to put templates behind an optional
directory for example:</li>
</ul>
<pre><code class="python">  Subrecord.get_modal_template(prefixes=[&quot;example&quot;])
</code></pre>

<p>Would use the first template it found, looking at:</p>
<pre><code>{{ template_dir }}/modals/example/subrecord_modal.html
{{ template_dir }}/modals/subrecord_modal.html
</code></pre>

<p>And default to a modal containing the <a href="#subrecordget_form_template">Subrecord.get_form_template</a>.</p>
<h4 id="subrecordget_modal_footer_template">Subrecord.get_modal_footer_template</h4>
<p>Classmethod to add a custom footer to a modal, used for example to denote if
the data from a model has been sourced from an external source</p>
<h4 id="subrecordbulk_update_from_dicts">Subrecord.bulk_update_from_dicts()</h4>
<p>A Classmethod to allow the creation of multiple objects.</p>
<p>Takes in the parent model - an episode
for EpisodeSubrecords a patient for PatientSubrecords. Under the covers it iterates
over all the subrecords, adds in the parent relationship and calls update_from_dict. It returns a list of the objects updated.</p>
<h3 id="subrecord-mixins">Subrecord Mixins</h3>
<h4 id="trackedmodel">TrackedModel</h4>
<p>A Tracked Model automatically has created, created_by, updated, updated_by and
these are only updated when used via the api</p>
<h4 id="externallysourcedmodel">ExternallySourcedModel</h4>
<p>Often we want data to be sourced from external systems, this mixin adds in the
fields external_system and external_identifier to allow us to track where
they come from and how they are referenced by that system.</p>
<p>These fields are then often used in forms to make the data read only</p></div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = "../..",
                shortcuts = {"search": 83, "previous": 80, "help": 191, "next": 78};
        </script>
        <script src="../../js/base.js" defer></script>
        <script src="../../search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Search</h4>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form role="form">
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="Keyboard Shortcuts Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Keyboard Shortcuts</h4>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
